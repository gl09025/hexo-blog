!function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery||window.Zepto)}(function(e,t){function a(){}function r(e,t){return(t._$container==_?("innerHeight"in f?f.innerHeight:_.height())+_.scrollTop():t._$container.offset().top+t._$container.height())<=e.offset().top-t.threshold}function n(e,t){return(t._$container==_?_.scrollTop():t._$container.offset().top)>=e.offset().top+t.threshold+e.height()}function o(t,a){var o=0;t.each(function(l,i){function c(){p.trigger("_lazyload_appear"),o=0}var s,d,h,u,p=t.eq(l);if(!(p.width()<=0&&p.height()<=0||"none"===p.css("display")))if(a.vertical_only)if(n(p,a));else if(r(p,a)){if(++o>a.failure_limit)return!1}else c();else if(n(p,a)||(h=p,u=a,(u._$container==_?e.fn.scrollLeft?_.scrollLeft():f.pageXOffset:u._$container.offset().left)>=h.offset().left+u.threshold+h.width()));else if(r(p,a)||(s=p,d=a,(d._$container==_?_.width()+(e.fn.scrollLeft?_.scrollLeft():f.pageXOffset):d._$container.offset().left+d._$container.width())<=s.offset().left-d.threshold)){if(++o>a.failure_limit)return!1}else c()})}function l(e){return e.filter(function(t,a){return!e.eq(t)._lazyload_loadStarted})}var i,c,f=window,_=e(f),s={threshold:0,failure_limit:0,event:"scroll",effect:"show",effect_params:null,container:f,data_attribute:"original",data_srcset_attribute:"original-srcset",skip_invisible:!0,appear:a,load:a,vertical_only:!1,check_appear_throttle_time:300,url_rewriter_fn:a,no_fake_img_loader:!1,placeholder_data_img:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsQAAA7EAZUrDhsAAAANSURBVBhXYzh8+PB/AAffA0nNPuCLAAAAAElFTkSuQmCC",placeholder_real_img:"http://ditu.baidu.cn/yyfm/lazyload/0.0.1/img/placeholder.png"};c=Object.prototype.toString,i=function(e){return c.call(e).replace("[object ","").replace("]","")},e.fn.hasOwnProperty("lazyload")||(e.fn.lazyload=function(t){var r,n,c,d=this;return e.isPlainObject(t)||(t={}),e.each(s,function(a,r){-1!=e.inArray(a,["threshold","failure_limit","check_appear_throttle_time"])?"String"==i(t[a])?t[a]=parseInt(t[a],10):t[a]=r:"container"==a?(t.hasOwnProperty(a)?t[a]==f||t[a]==document?t._$container=_:t._$container=e(t[a]):t._$container=_,delete t.container):!s.hasOwnProperty(a)||t.hasOwnProperty(a)&&i(t[a])==i(s[a])||(t[a]=r)}),r="scroll"==t.event,c=0==t.check_appear_throttle_time?o:function(e,t){function a(){l=0,i=+new Date,o=e.apply(r,n),r=null,n=null}var r,n,o,l,i=0;return function(){r=this,n=arguments;var e=new Date-i;return l||(e>=t?a():l=setTimeout(a,t-e)),o}}(o,t.check_appear_throttle_time),n=r||"scrollstart"==t.event||"scrollstop"==t.event,d.each(function(r,o){var i=this,c=d.eq(r),f=c.attr("src"),_=c.attr("data-"+t.data_attribute),s=t.url_rewriter_fn==a?_:t.url_rewriter_fn.call(i,c,_),h=c.attr("data-"+t.data_srcset_attribute),u=c.is("img");return 1==c._lazyload_loadStarted||f==s?(c._lazyload_loadStarted=!0,void(d=l(d))):(c._lazyload_loadStarted=!1,u&&!f&&c.one("error",function(){c.attr("src",t.placeholder_real_img)}).attr("src",t.placeholder_data_img),c.one("_lazyload_appear",function(){function r(){n&&c.hide(),u?(h&&c.attr("srcset",h),s&&c.attr("src",s)):c.css("background-image",'url("'+s+'")'),n&&c[t.effect].apply(c,o?t.effect_params:[]),d=l(d)}var n,o=e.isArray(t.effect_params);c._lazyload_loadStarted||(n="show"!=t.effect&&e.fn[t.effect]&&(!t.effect_params||o&&0==t.effect_params.length),t.appear!=a&&t.appear.call(i,c,d.length,t),c._lazyload_loadStarted=!0,t.no_fake_img_loader||h?(t.load!=a&&c.one("load",function(){t.load.call(i,c,d.length,t)}),r()):e("<img />").one("load",function(){r(),t.load!=a&&t.load.call(i,c,d.length,t)}).attr("src",s))}),void(n||c.on(t.event,function(){c._lazyload_loadStarted||c.trigger("_lazyload_appear")})))}),n&&t._$container.on(t.event,function(){c(d,t)}),_.on("resize load",function(){c(d,t)}),e(function(){c(d,t)}),this})});